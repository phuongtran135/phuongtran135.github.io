<!DOCTYPE html>
<html lang="vi" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trình Dịch Truyện AI</title>
    <!-- Sử dụng Tailwind CSS để làm giao diện đẹp và nhanh chóng -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Thư viện mammoth.js để đọc file .docx -->
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.7.0/mammoth.browser.min.js"></script>
    <!-- Link to Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <!-- Liên kết tới file CSS ngoài -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
  </head>
  <body class="bg-slate-900 text-slate-200 transition-colors duration-300">
    <div class="w-full max-w-6xl mx-auto p-4">
      <div
        class="w-full bg-slate-800 rounded-2xl shadow-xl p-6 md:p-8 space-y-6"
      >
        <!-- Header -->
        <div class="text-center">
          <h1 class="text-3xl md:text-4xl font-bold text-slate-100">
            Trình Dịch Truyện & Phụ Đề AI
          </h1>
          <p class="text-slate-400 mt-2">
            Tải lên file, dán văn bản thô hoặc HTML và để AI dịch.
          </p>
        </div>

        <!-- Vùng cài đặt và tải lên -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
          <!-- Cột trái: API Key và Ngôn ngữ -->
          <div class="space-y-4">
            <!-- Gemini API Key Management -->
            <div>
              <label class="block text-sm font-medium text-slate-300 mb-1">
                <span>Quản lý Gemini API Keys</span>
                <span class="text-red-500">*</span>
              </label>
              <button
                id="manageApiKeysBtn"
                class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md shadow-sm text-left flex justify-between items-center hover:bg-slate-600 transition-colors"
              >
                <span class="text-slate-300"
                  >Đã lưu
                  <span id="apiKeyCount" class="font-bold text-cyan-400"
                    >0</span
                  >
                  key(s)</span
                >
                <span class="text-xs text-slate-400">Nhấn để sửa</span>
              </button>
              <p class="text-xs text-slate-400 mt-1">
                <span>Lấy API key tại</span>
                <a
                  href="https://aistudio.google.com/apikey"
                  target="_blank"
                  class="text-blue-500 hover:underline"
                  >aistudio.google.com</a
                >
              </p>
            </div>
            <!-- Language and Thread Count -->
            <div class="grid grid-cols-2 gap-x-4">
              <!-- Language Select -->
              <div>
                <label
                  for="language"
                  class="block text-sm font-medium text-slate-300 mb-1"
                  >Dịch sang</label
                >
                <select
                  id="language"
                  name="language"
                  class="block w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-slate-100"
                >
                  <option value="Vietnamese">Tiếng Việt</option>
                  <option value="English">Tiếng Anh</option>
                  <option value="Japanese">Tiếng Nhật</option>
                  <option value="Korean">Tiếng Hàn</option>
                  <option value="Chinese (Simplified)">Tiếng Trung</option>
                </select>
              </div>
              <!-- Thread Selection -->
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-1"
                  >Số luồng dịch</label
                >
                <div
                  id="threadSelection"
                  class="flex items-center flex-wrap gap-x-3 bg-slate-700 border border-slate-600 rounded-md p-2 h-auto min-h-[42px]"
                >
                  <label
                    for="threadCount1"
                    class="flex items-center text-sm cursor-pointer"
                  >
                    <input
                      type="radio"
                      id="threadCount1"
                      name="threadCount"
                      value="1"
                      class="h-4 w-4 text-blue-600 border-slate-500 bg-slate-800 focus:ring-blue-500"
                      checked
                    />
                    <span class="ml-2 text-slate-200">1</span>
                  </label>
                  <label
                    for="threadCount2"
                    class="flex items-center text-sm cursor-pointer"
                    title="Yêu cầu tối thiểu 4 API keys"
                  >
                    <input
                      type="radio"
                      id="threadCount2"
                      name="threadCount"
                      value="2"
                      class="h-4 w-4 text-blue-600 border-slate-500 bg-slate-800 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50"
                      disabled
                    />
                    <span class="ml-2 text-slate-200">2</span>
                  </label>
                  <label
                    for="threadCount5"
                    class="flex items-center text-sm cursor-pointer"
                    title="Yêu cầu tối thiểu 10 API keys"
                  >
                    <input
                      type="radio"
                      id="threadCount5"
                      name="threadCount"
                      value="5"
                      class="h-4 w-4 text-blue-600 border-slate-500 bg-slate-800 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50"
                      disabled
                    />
                    <span class="ml-2 text-slate-200">5</span>
                  </label>
                  <label
                    for="threadCount50p"
                    class="flex items-center text-sm cursor-pointer"
                    title="Yêu cầu tối thiểu 12 API keys"
                  >
                    <input
                      type="radio"
                      id="threadCount50p"
                      name="threadCount"
                      value="50p"
                      class="h-4 w-4 text-blue-600 border-slate-500 bg-slate-800 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50"
                      disabled
                    />
                    <span class="ml-2 text-slate-200">50%</span>
                  </label>
                </div>
              </div>
            </div>
            <!-- Thread Warning -->
            <div
              id="threadWarning"
              class="hidden text-xs text-amber-400 mt-2 p-2 rounded-md bg-amber-900/30 border border-amber-800/50"
            >
              <!-- Warning text will be injected by JS -->
            </div>
            <!-- Custom Prompt -->
            <div id="custom-prompt-container">
              <div class="flex items-center">
                <input
                  id="customPromptToggle"
                  type="checkbox"
                  class="h-4 w-4 rounded border-gray-600 text-blue-600 focus:ring-blue-500 bg-slate-700"
                />
                <label
                  for="customPromptToggle"
                  class="ml-2 block text-sm font-medium text-slate-300"
                  >Tùy chỉnh prompt (hướng dẫn thêm)</label
                >
              </div>
              <textarea
                id="customPrompt"
                rows="4"
                class="hidden mt-2 w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-slate-100"
              ></textarea>
            </div>
          </div>
          <!-- Cột phải: Tải file lên / Dán văn bản -->
          <div>
            <div class="flex border-b border-slate-700 mb-4">
              <button
                id="uploadTab"
                class="px-4 py-2 text-sm font-semibold border-b-2 tab-active"
              >
                Tải File
              </button>
              <button
                id="pasteTab"
                class="px-4 py-2 text-sm font-semibold text-slate-400 border-b-2 border-transparent hover:text-slate-200"
              >
                Dán Văn Bản
              </button>
            </div>

            <!-- Upload Panel -->
            <div id="uploadPanel">
              <label class="block text-sm font-medium text-slate-300 mb-1">
                <span>File truyện (.docx) hoặc phụ đề (.srt)</span>
                <span class="text-red-500">*</span>
              </label>
              <label
                for="docFile"
                class="custom-file-upload flex flex-col items-center justify-center w-full h-full rounded-md cursor-pointer p-6 text-center min-h-[178px] border-slate-600"
              >
                <svg
                  id="uploadIcon"
                  class="w-12 h-12 text-slate-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
                  ></path>
                </svg>
                <div class="flex items-center space-x-2 mt-2">
                  <span id="fileName" class="text-sm text-slate-400 break-all"
                    >Kéo và thả hoặc nhấn để chọn file</span
                  >
                  <button
                    id="clearFileBtn"
                    type="button"
                    class="hidden p-1 bg-red-500 text-white rounded-full hover:bg-red-600 focus:outline-none"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                        clip-rule="evenodd"
                      ></path>
                    </svg>
                  </button>
                </div>
              </label>
              <input
                type="file"
                id="docFile"
                class="hidden"
                accept=".docx,.srt"
              />
            </div>

            <!-- Paste Panel -->
            <div id="pastePanel" class="hidden">
              <label
                for="pasteInput"
                class="block text-sm font-medium text-slate-300 mb-1"
              >
                <span>Dán nội dung truyện (văn bản thô hoặc HTML)</span>
                <span class="text-red-500">*</span>
              </label>
              <textarea
                id="pasteInput"
                rows="7"
                class="block w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-slate-100"
                placeholder="Dán nội dung vào đây... Hệ thống sẽ tự động trích xuất văn bản từ HTML nếu được dán vào."
              ></textarea>
            </div>

            <!-- Character Count Display -->
            <div
              id="characterCountContainer"
              class="hidden text-sm text-slate-400 mt-2"
            >
              <span>Tổng số ký tự: </span>
              <span id="totalCharCount" class="font-semibold text-slate-300"
                >0</span
              >
            </div>
          </div>
        </div>

        <!-- Nút hành động và Trạng thái -->
        <div class="flex flex-col items-center space-y-3 pt-4">
          <div class="flex flex-wrap items-center justify-center gap-4">
            <button
              id="translateBtn"
              class="px-6 py-2 text-sm font-semibold bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors"
              disabled
            >
              <span>Bắt đầu dịch</span>
            </button>
            <!-- NEW: Publication Evaluation Button -->
            <button
              id="evaluateBtn"
              class="hidden px-4 py-2 text-sm bg-purple-600 text-white font-semibold rounded-lg shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors flex items-center space-x-2 disabled:bg-slate-400 disabled:cursor-not-allowed"
            >
              <svg
                class="w-5 h-5"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  d="M10 3.5a1.5 1.5 0 01.52 2.924A5.503 5.503 0 007.58 11H7.5a1.5 1.5 0 010-3h.082a5.503 5.503 0 002.938-5.024A1.5 1.5 0 0110 3.5z"
                />
                <path
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm0-1.5a6.5 6.5 0 110-13 6.5 6.5 0 010 13z"
                />
              </svg>
              <span>Đánh giá xuất bản</span>
            </button>
            <button
              id="addCommentBtn"
              class="hidden px-4 py-2 text-sm bg-teal-600 text-white font-semibold rounded-lg shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-colors flex items-center space-x-2"
            >
              <svg
                class="w-5 h-5"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.02-3.06A8.005 8.005 0 012 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM4.415 12.944a6.002 6.002 0 0011.17 0l.115-.345a6.002 6.002 0 00-11.4 0l.115.345z"
                  clip-rule="evenodd"
                />
              </svg>
              <span>Thêm Comment HTML</span>
            </button>
          </div>
          <div
            id="status"
            class="h-6 flex items-center space-x-2 text-sm text-slate-400"
          ></div>
          <!-- ADDED: Timer Display -->
          <div
            id="timerDisplay"
            class="hidden text-sm text-cyan-400 font-mono"
          ></div>
        </div>

        <!-- Detailed Status Area -->
        <div
          id="detailedStatusContainer"
          class="hidden w-full bg-slate-900/50 p-4 rounded-lg border border-slate-700 space-y-2"
        >
          <!-- Status lines will be injected here by JS -->
        </div>
        <div id="retryContainer" class="hidden text-center mt-2">
          <button
            id="retryTranslationBtn"
            class="px-4 py-2 text-sm bg-yellow-500 text-black font-semibold rounded-lg shadow-sm hover:bg-yellow-600"
          >
            Thử lại lần dịch lỗi
          </button>
        </div>

        <!-- Vùng Comment đã định dạng (hiển thị trước khi dịch) -->
        <div id="commentSection" class="hidden pt-6 border-t border-slate-700">
          <div class="flex flex-wrap justify-between items-center gap-y-2 mb-4">
            <div class="flex items-center gap-x-3">
              <h3 class="text-xl font-bold text-slate-100">
                Comment đã định dạng
              </h3>
              <button
                id="toggleCommentsBtn"
                title="Ẩn/Hiện Comments"
                class="text-slate-400 hover:text-white"
              >
                <i class="fa-solid fa-eye"></i>
              </button>
            </div>
            <div id="commentActions" class="hidden items-center gap-x-2">
              <button
                id="translateAllCommentsGoogleBtn"
                class="px-3 py-1 text-xs bg-green-600 text-white font-semibold rounded-lg shadow-sm hover:bg-green-700 flex items-center gap-x-1.5 disabled:bg-slate-500"
              >
                <i class="fa-brands fa-google"></i>
                <span>Dịch nhanh toàn bộ</span>
              </button>
              <button
                id="translateAllCommentsAIBtn"
                class="px-3 py-1 text-xs bg-indigo-600 text-white font-semibold rounded-lg shadow-sm hover:bg-indigo-700 flex items-center gap-x-1.5 disabled:bg-slate-500"
              >
                <i class="fa-solid fa-wand-magic-sparkles"></i>
                <span>Dịch AI toàn bộ</span>
              </button>
            </div>
          </div>
          <div
            id="formattedCommentsOutput"
            class="w-full max-h-80 overflow-y-auto bg-slate-900 p-2 rounded-md border border-slate-700"
          ></div>
        </div>

        <!-- NEW: Publication Evaluation Result Area -->
        <div
          id="evaluationResultArea"
          class="hidden pt-6 border-t border-slate-700"
        >
          <div class="flex flex-wrap justify-between items-center gap-y-2 mb-4">
            <div class="flex items-center gap-x-3">
              <h3
                class="text-xl font-bold text-slate-100 flex items-center gap-x-2"
              >
                <i class="fa-solid fa-feather-pointed text-purple-400"></i>
                <span>Đánh giá khả năng xuất bản</span>
              </h3>
              <button
                id="toggleEvaluationBtn"
                title="Ẩn/Hiện Đánh giá"
                class="text-slate-400 hover:text-white"
              >
                <i class="fa-solid fa-eye"></i>
              </button>
            </div>
          </div>
          <div
            id="evaluationOutput"
            class="w-full max-h-[40rem] overflow-y-auto bg-slate-900 p-4 rounded-md border border-purple-800 whitespace-pre-wrap"
          ></div>
        </div>

        <!-- Lịch sử Dịch -->
        <div id="historyArea" class="hidden pt-6 border-t border-slate-700">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-slate-100">
              Lịch sử dịch gần đây
            </h2>
            <div>
              <button
                id="clearStoryHistoryBtn"
                class="px-3 py-1 text-xs bg-red-600 text-white font-semibold rounded-lg shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"
              >
                Xóa lịch sử truyện
              </button>
              <button
                id="clearSubtitleHistoryBtn"
                class="hidden px-3 py-1 text-xs bg-red-600 text-white font-semibold rounded-lg shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors"
              >
                Xóa lịch sử phụ đề
              </button>
            </div>
          </div>
          <!-- Tabs -->
          <div class="flex border-b border-slate-700 mb-4">
            <button
              id="storyHistoryTab"
              class="px-4 py-2 text-sm font-semibold text-slate-300 border-b-2"
            >
              Truyện (.docx)
            </button>
            <button
              id="subtitleHistoryTab"
              class="px-4 py-2 text-sm font-semibold text-slate-400 border-b-2 border-transparent hover:text-slate-200"
            >
              Phụ đề (.srt)
            </button>
          </div>
          <!-- History Lists -->
          <div
            id="storyHistoryList"
            class="space-y-2 max-h-48 overflow-y-auto"
          ></div>
          <div
            id="subtitleHistoryList"
            class="hidden space-y-2 max-h-48 overflow-y-auto"
          ></div>
        </div>

        <!-- Vùng kết quả -->
        <div id="resultArea" class="hidden pt-6 border-t border-slate-700">
          <div
            class="flex flex-wrap justify-between items-center gap-y-4 gap-x-2 mb-4"
          >
            <h2 class="text-2xl font-bold text-slate-100">Kết quả đã dịch</h2>
            <div class="flex items-center gap-x-2 flex-wrap">
              <button
                id="titleSuggestionBtn"
                class="px-3 py-1.5 text-sm bg-sky-600 text-white font-semibold rounded-lg shadow-sm hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors flex items-center space-x-2 disabled:bg-slate-400 disabled:cursor-not-allowed"
              >
                <svg
                  class="w-5 h-5"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                  />
                </svg>
                <span>Gợi ý tên truyện</span>
              </button>
              <button
                id="qualityCheckBtn"
                class="px-3 py-1.5 text-sm bg-amber-500 text-white font-semibold rounded-lg shadow-sm hover:bg-amber-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 transition-colors flex items-center space-x-2 disabled:bg-slate-400 disabled:cursor-not-allowed"
              >
                <svg
                  class="w-5 h-5"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                    clip-rule="evenodd"
                  />
                </svg>
                <span>Kiểm tra bản dịch</span>
              </button>
              <button
                id="copyBtn"
                class="px-3 py-1.5 text-sm bg-slate-600 text-white font-semibold rounded-lg shadow-sm hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-colors"
              >
                <span>Sao chép bản dịch</span>
              </button>
            </div>
          </div>
          <div
            id="translatedOutput"
            class="w-full h-96 overflow-y-auto bg-slate-900 p-4 rounded-md border border-slate-700 whitespace-pre-wrap"
          ></div>

          <!-- Vùng Gợi ý tên truyện -->
          <div id="titleSuggestionArea" class="hidden mt-6">
            <h3 class="text-xl font-bold text-slate-100 mb-2">
              Gợi ý tên truyện
            </h3>
            <div
              id="titleSuggestionOutput"
              class="w-full h-64 overflow-y-auto bg-sky-900/20 p-4 rounded-md border border-sky-900/30 whitespace-pre-wrap"
            ></div>
            <div class="mt-4 flex justify-end">
              <button
                id="suggestAgainBtn"
                class="px-3 py-1.5 text-sm bg-sky-600 text-white font-semibold rounded-lg shadow-sm hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors flex items-center space-x-2 disabled:bg-slate-400 disabled:cursor-not-allowed"
              >
                <svg
                  class="w-5 h-5"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm1 14a1 1 0 011-1h5.001a5.002 5.002 0 004.087-7.926 1 1 0 111.885.666A7.002 7.002 0 015 17.899V20a1 1 0 11-2 0v-5a1 1 0 011-1z"
                    clip-rule="evenodd"
                  />
                </svg>
                <span>Gợi ý lại</span>
              </button>
            </div>
          </div>

          <!-- Vùng Phân tích chất lượng -->
          <div id="qualityCheckResultArea" class="hidden mt-6">
            <h3 class="text-xl font-bold text-slate-100 mb-2">
              Phân tích chất lượng bản dịch
            </h3>
            <div
              id="qualityCheckOutput"
              class="w-full h-64 overflow-y-auto bg-amber-900/20 p-4 rounded-md border border-amber-900/30 whitespace-pre-wrap"
            ></div>
            <div class="mt-4 flex justify-end">
              <button
                id="regenerateBtn"
                class="px-3 py-1.5 text-sm bg-green-600 text-white font-semibold rounded-lg shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors flex items-center space-x-2 disabled:bg-slate-400 disabled:cursor-not-allowed"
              >
                <svg
                  class="w-5 h-5"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm1 14a1 1 0 011-1h5.001a5.002 5.002 0 004.087-7.926 1 1 0 111.885.666A7.002 7.002 0 015 17.899V20a1 1 0 11-2 0v-5a1 1 0 011-1z"
                    clip-rule="evenodd"
                  />
                </svg>
                <span>Áp dụng & Dịch lại</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div
      id="confirmationModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center"
    >
      <div class="bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-sm">
        <h3 class="text-lg font-bold text-white mb-4" id="modalTitle">
          Xác nhận
        </h3>
        <p class="text-slate-300 mb-6" id="modalMessage">
          Bạn có chắc chắn muốn thực hiện hành động này?
        </p>
        <div class="flex justify-end space-x-4">
          <button
            id="modalCancelBtn"
            class="px-4 py-2 text-sm font-semibold bg-slate-600 text-white rounded-lg hover:bg-slate-700"
          >
            Hủy
          </button>
          <button
            id="modalConfirmBtn"
            class="px-4 py-2 text-sm font-semibold bg-red-600 text-white rounded-lg hover:bg-red-700"
          >
            Xóa
          </button>
        </div>
      </div>
    </div>

    <!-- Rename Modal -->
    <div
      id="renameModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center"
    >
      <div class="bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-sm">
        <h3 class="text-lg font-bold text-white mb-4">Đổi tên lịch sử</h3>
        <input
          type="text"
          id="renameInput"
          class="block w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md text-slate-100 mb-6"
        />
        <div class="flex justify-end space-x-4">
          <button
            id="renameCancelBtn"
            class="px-4 py-2 text-sm font-semibold bg-slate-600 text-white rounded-lg hover:bg-slate-700"
          >
            Hủy
          </button>
          <button
            id="renameSaveBtn"
            class="px-4 py-2 text-sm font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700"
          >
            Lưu
          </button>
        </div>
      </div>
    </div>

    <!-- Comment Modal -->
    <div
      id="commentModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4"
    >
      <div class="bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-lg">
        <h3 class="text-lg font-bold text-white mb-4">Dán Comment HTML</h3>
        <p class="text-slate-400 text-sm mb-4">
          Dán nội dung HTML có chứa các comment (ví dụ: từ Zhihu). Hệ thống sẽ
          tự động trích xuất tên tác giả và nội dung.
        </p>
        <textarea
          id="commentHtmlInput"
          rows="10"
          class="block w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-slate-100"
          placeholder="Dán toàn bộ mã HTML của vùng comment vào đây..."
        ></textarea>
        <div class="flex justify-end space-x-4 mt-6">
          <button
            id="commentCancelBtn"
            class="px-4 py-2 text-sm font-semibold bg-slate-600 text-white rounded-lg hover:bg-slate-700"
          >
            Hủy
          </button>
          <button
            id="processCommentBtn"
            class="px-4 py-2 text-sm font-semibold bg-teal-600 text-white rounded-lg hover:bg-teal-700"
          >
            Xử lý
          </button>
        </div>
      </div>
    </div>

    <!-- API Key Modal -->
    <div
      id="apiKeyModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4"
    >
      <div class="bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-lg">
        <h3 class="text-lg font-bold text-white mb-4">
          Quản lý Gemini API Keys
        </h3>
        <p class="text-slate-400 text-sm mb-4">
          Dán các API key của bạn vào đây, mỗi key trên một dòng. Dữ liệu sẽ
          được lưu trữ an toàn trong trình duyệt của bạn.
        </p>
        <textarea
          id="geminiApiKey"
          rows="10"
          class="block w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-md shadow-sm placeholder-slate-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-slate-100"
          placeholder="Dán API keys..."
        ></textarea>
        <div class="flex justify-end space-x-4 mt-6">
          <button
            id="apiKeyCancelBtn"
            class="px-4 py-2 text-sm font-semibold bg-slate-600 text-white rounded-lg hover:bg-slate-700"
          >
            Hủy
          </button>
          <button
            id="apiKeySaveBtn"
            class="px-4 py-2 text-sm font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700"
          >
            Lưu Keys
          </button>
        </div>
      </div>
    </div>

    <!-- Liên kết tới file JavaScript ngoài -->
    <script src="script.js"></script>
  </body>
</html>
