<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tools Suite - Công cụ AI chuyên nghiệp</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Thư viện mammoth.js để đọc file .docx -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-gray-900 text-gray-200">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-white">
                <i class="fas fa-magic-wand-sparkles mr-2 text-blue-400"></i>AI Tools Suite
            </h1>
            <p class="text-gray-400 mt-2 text-lg">Công cụ tạo phụ đề và dịch thuật chuyên nghiệp.</p>
        </header>

        <!-- Khu vực quản lý API Key -->
        <div class="mb-10 bg-gray-800 p-4 rounded-xl shadow-lg border border-gray-700">
            <details>
                <summary class="cursor-pointer font-semibold text-lg flex justify-between items-center text-gray-200">
                    <span><i class="fas fa-key mr-2 text-yellow-400"></i>Quản lý API Key Gemini</span>
                    <span class="transform transition-transform duration-300">
                       <i class="fas fa-chevron-down"></i>
                    </span>
                </summary>
                <div class="mt-4 border-t border-gray-700 pt-4">
                    <p class="text-sm text-gray-400 mb-2">
                        Nhập API Key của bạn từ <a href="https://aistudio.google.com/api-keys" target="_blank" class="text-blue-400 hover:underline">Google AI Studio</a>. Mỗi key một dòng.
                        Hệ thống sẽ tự động sử dụng và chuyển đổi khi cần thiết.
                    </p>
                     <div id="api-status" class="mb-2 text-sm"></div>
                    <textarea id="api-keys-input" class="w-full p-3 border border-gray-600 rounded-md h-24 bg-gray-700 text-gray-200 placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="dán API key vào đây..."></textarea>
                    <div class="flex items-center justify-between mt-3">
                        <button id="save-api-keys" class="bg-blue-600 text-white px-5 py-2 rounded-md hover:bg-blue-700 transition duration-300 flex items-center font-semibold">
                            <i class="fas fa-save mr-2"></i>Lưu Keys
                        </button>
                         <button id="clear-db" class="bg-red-600 text-white px-5 py-2 rounded-md hover:bg-red-700 transition duration-300 flex items-center font-semibold">
                            <i class="fas fa-trash-alt mr-2"></i>Dọn dẹp bộ nhớ
                        </button>
                    </div>
                    <div id="saved-keys-list" class="mt-4">
                        <h4 class="font-semibold text-gray-200">API Keys đã lưu:</h4>
                        <ul id="keys-ul" class="mt-2 text-sm text-gray-400">
                            <!-- Keys sẽ được hiển thị ở đây -->
                        </ul>
                    </div>
                </div>
            </details>
        </div>

        <!-- Công cụ tạo phụ đề -->
        <section id="subtitle-generator" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-white border-b-2 border-blue-500 pb-3">Trình tạo Phụ đề</h2>
            <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Cột nhập liệu -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
                    <h3 class="text-xl font-bold mb-4 border-b border-gray-700 pb-3 text-gray-100">1. Nhập liệu Phụ đề</h3>

                    <div class="mb-6">
                        <label for="srt-file" class="block font-semibold mb-2 text-gray-300"><i class="fas fa-clock mr-2 text-teal-400"></i>Tải lên file SRT chứa thời gian (Bắt buộc)</label>
                        <div id="srt-drop-zone" class="border-2 border-dashed border-gray-600 rounded-lg p-6 text-center cursor-pointer hover:border-teal-500 hover:bg-gray-700/50 transition bg-gray-800/50">
                           <input type="file" id="srt-file" accept=".srt" class="hidden">
                           <label for="srt-file" class="cursor-pointer">
                                <i class="fas fa-upload text-3xl text-gray-500 mb-2"></i>
                                <p id="srt-file-name" class="text-gray-400">Nhấn để chọn file SRT làm mẫu thời gian</p>
                           </label>
                        </div>
                    </div>

                    <div>
                        <label for="text-content" class="block font-semibold mb-2 text-gray-300"><i class="fas fa-file-alt mr-2 text-green-400"></i>Nội dung truyện chính xác</label>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-sm text-gray-400">Dán nội dung vào đây:</span>
                             <label for="docx-file" class="text-sm text-blue-400 hover:underline cursor-pointer">
                                hoặc tải lên từ file .docx
                                <input type="file" id="docx-file" accept=".docx" class="hidden">
                            </label>
                        </div>
                        <textarea id="text-content" class="w-full p-3 border border-gray-600 rounded-md h-64 bg-gray-700 text-gray-200 placeholder-gray-400 focus:ring-2 focus:ring-green-500 focus:border-green-500 transition" placeholder="Nhập hoặc dán nội dung văn bản đầy đủ và chính xác của bạn..."></textarea>
                    </div>
                    
                     <div class="mt-6">
                        <button id="generate-vi-btn" class="w-full bg-gradient-to-r from-blue-600 to-purple-700 text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition transform hover:scale-105 duration-300 flex items-center justify-center text-lg shadow-md">
                            <i class="fas fa-play mr-3"></i>
                            <span>Tạo Phụ đề Tiếng Việt</span>
                        </button>
                    </div>
                </div>

                <!-- Cột kết quả -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
                    <h3 class="text-xl font-bold mb-4 border-b border-gray-700 pb-3 text-gray-100">2. Kết quả Phụ đề</h3>
                    <div id="result-container" class="space-y-6">
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-semibold text-gray-200"><i class="fas fa-language mr-2"></i>Tiếng Việt (.srt)</h4>
                                <div class="flex items-center space-x-2">
                                    <button data-lang="vi" class="regenerate-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition hidden"><i class="fas fa-sync-alt"></i></button>
                                    <button data-target="srt-vi" class="copy-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-copy"></i></button>
                                    <button data-lang="vi" class="download-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-download"></i></button>
                                </div>
                            </div>
                            <textarea id="srt-vi" readonly class="w-full p-3 border border-gray-700 rounded-md h-40 bg-gray-900 text-gray-300 font-mono text-sm"></textarea>
                        </div>

                        <!-- Nút tạo các ngôn ngữ khác -->
                        <div id="secondary-generation-options" class="hidden border-t border-b border-gray-700 my-4 py-4 space-y-3">
                             <h4 class="font-semibold text-gray-300 text-center">Tạo các ngôn ngữ khác từ bản Tiếng Việt</h4>
                             <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                                 <button data-lang="en" class="secondary-generate-btn w-full bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-500 transition flex items-center justify-center">
                                    <i class="fas fa-language mr-2"></i>
                                    <span>Tạo Tiếng Anh</span>
                                 </button>
                                 <button data-lang="ja" class="secondary-generate-btn w-full bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-500 transition flex items-center justify-center">
                                    <i class="fas fa-language mr-2"></i>
                                    <span>Tạo Tiếng Nhật</span>
                                 </button>
                                 <button data-lang="ko" class="secondary-generate-btn w-full bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-500 transition flex items-center justify-center">
                                    <i class="fas fa-language mr-2"></i>
                                    <span>Tạo Tiếng Hàn</span>
                                 </button>
                             </div>
                        </div>

                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-semibold text-gray-200 flex items-center"><i class="fas fa-language mr-2"></i><span>Tiếng Anh (.srt)</span><i id="en-loader" class="fas fa-spinner fa-spin ml-2 hidden"></i></h4>
                                <div class="flex items-center space-x-2">
                                    <button data-lang="en" class="regenerate-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition hidden"><i class="fas fa-sync-alt"></i></button>
                                    <button data-target="srt-en" class="copy-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-copy"></i></button>
                                    <button data-lang="en" class="download-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-download"></i></button>
                                </div>
                            </div>
                            <textarea id="srt-en" readonly class="w-full p-3 border border-gray-700 rounded-md h-40 bg-gray-900 text-gray-300 font-mono text-sm"></textarea>
                            <p id="en-status" class="text-xs text-gray-500 mt-1 h-4"></p>
                        </div>

                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-semibold text-gray-200 flex items-center"><i class="fas fa-language mr-2"></i><span>Tiếng Nhật (.srt)</span><i id="ja-loader" class="fas fa-spinner fa-spin ml-2 hidden"></i></h4>
                                <div class="flex items-center space-x-2">
                                    <button data-lang="ja" class="regenerate-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition hidden"><i class="fas fa-sync-alt"></i></button>
                                    <button data-target="srt-ja" class="copy-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-copy"></i></button>
                                    <button data-lang="ja" class="download-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-download"></i></button>
                                </div>
                            </div>
                            <textarea id="srt-ja" readonly class="w-full p-3 border border-gray-700 rounded-md h-40 bg-gray-900 text-gray-300 font-mono text-sm"></textarea>
                            <p id="ja-status" class="text-xs text-gray-500 mt-1 h-4"></p>
                        </div>

                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-semibold text-gray-200 flex items-center"><i class="fas fa-language mr-2"></i><span>Tiếng Hàn (.srt)</span><i id="ko-loader" class="fas fa-spinner fa-spin ml-2 hidden"></i></h4>
                                <div class="flex items-center space-x-2">
                                     <button data-lang="ko" class="regenerate-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition hidden"><i class="fas fa-sync-alt"></i></button>
                                    <button data-target="srt-ko" class="copy-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-copy"></i></button>
                                    <button data-lang="ko" class="download-btn bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-download"></i></button>
                                </div>
                            </div>
                            <textarea id="srt-ko" readonly class="w-full p-3 border border-gray-700 rounded-md h-40 bg-gray-900 text-gray-300 font-mono text-sm"></textarea>
                            <p id="ko-status" class="text-xs text-gray-500 mt-1 h-4"></p>
                        </div>
                    </div>
                     <div id="loader-container" class="hidden flex-col items-center justify-center h-full text-center text-gray-400">
                        <div class="loader"></div>
                        <p id="loader-main-text" class="mt-4 text-lg">AI đang xử lý, vui lòng chờ trong giây lát...</p>
                        <p id="loader-details" class="text-sm mt-1 text-gray-500"></p>
                        <div id="thread-status-container" class="mt-4 w-full max-w-lg space-y-2"></div>
                    </div>
                </div>
            </main>
        </section>
        
        <!-- Công cụ dịch thuật -->
        <section id="translator">
            <h2 class="text-3xl font-bold text-center mb-8 text-white border-b-2 border-green-500 pb-3">Trình dịch thuật nội dung</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Cột nhập liệu dịch thuật -->
                <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
                    <h3 class="text-xl font-bold mb-4 border-b border-gray-700 pb-3 text-gray-100">1. Nhập liệu Dịch thuật</h3>
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="trans-genre" class="block font-semibold mb-2 text-gray-300">Thể Loại Truyện</label>
                                <select id="trans-genre-select" class="w-full p-2 border border-gray-600 rounded-md bg-gray-700 text-gray-200">
                                    <option value="Audio Tâm Lý Tội Phạm">Audio Tâm Lý Tội Phạm</option>
                                    <option value="Audio Trinh Thám">Audio Trinh Thám</option>
                                    <option value="Audio Kinh Dị">Audio Kinh Dị</option>
                                    <option value="Audio Cổ Trang">Audio Cổ Trang</option>
                                    <option value="Truyện Audio">Truyện Audio</option>
                                    <option value="custom">Tùy chỉnh...</option>
                                </select>
                                <input type="text" id="trans-genre-custom" class="w-full p-2 border border-gray-600 rounded-md bg-gray-700 text-gray-200 mt-2 hidden" placeholder="Nhập thể loại tùy chỉnh">
                            </div>
                             <div>
                                <label for="trans-title" class="block font-semibold mb-2 text-gray-300">Tên Truyện</label>
                                <input type="text" id="trans-title" class="w-full p-2 border border-gray-600 rounded-md bg-gray-700 text-gray-200" placeholder="Nhập tên truyện">
                            </div>
                        </div>

                        <div>
                            <label for="trans-summary" class="block font-semibold mb-2 text-gray-300">Nội dung tóm tắt</label>
                            <div class="flex items-center space-x-2 mb-2">
                               <label for="trans-docx-file" class="text-sm text-blue-400 hover:underline cursor-pointer">Tải lên từ file .docx</label>
                               <input type="file" id="trans-docx-file" accept=".docx" class="hidden">
                            </div>
                            <textarea id="trans-summary" class="w-full p-3 border border-gray-600 rounded-md h-40 bg-gray-700 text-gray-200" placeholder="Dán nội dung cần AI tóm tắt..."></textarea>
                        </div>
                        
                        <div>
                             <label class="block font-semibold mb-2 text-gray-300">Mạng xã hội</label>
                             <div id="social-media-list" class="space-y-2"></div>
                             <button id="add-social-btn" class="mt-2 text-sm bg-gray-600 text-gray-200 px-3 py-1 rounded-md hover:bg-gray-500 transition"><i class="fas fa-plus"></i> Thêm mạng xã hội</button>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="trans-hashtags" class="block font-semibold mb-2 text-gray-300">Hashtags (thêm)</label>
                                <input type="text" id="trans-hashtags" class="w-full p-2 border border-gray-600 rounded-md bg-gray-700 text-gray-200" placeholder="cách nhau bằng dấu phẩy">
                            </div>
                            <div>
                                <label for="trans-keywords" class="block font-semibold mb-2 text-gray-300">Keywords (thêm)</label>
                                <input type="text" id="trans-keywords" class="w-full p-2 border border-gray-600 rounded-md bg-gray-700 text-gray-200" placeholder="cách nhau bằng dấu phẩy">
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-700 pt-4">
                             <label for="trans-lang" class="block font-semibold mb-2 text-gray-300">Dịch sang ngôn ngữ</label>
                             <div class="flex items-center gap-4">
                                <select id="trans-lang" class="w-full p-3 border border-gray-600 rounded-md bg-gray-700 text-gray-200">
                                    <option value="vietnamese">Tiếng Việt</option>
                                    <option value="english">Tiếng Anh</option>
                                    <option value="korean">Tiếng Hàn</option>
                                    <option value="japanese">Tiếng Nhật</option>
                                </select>
                                <button id="translate-btn" class="w-1/2 bg-gradient-to-r from-emerald-500 to-green-600 text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 transition transform hover:scale-105 duration-300 flex items-center justify-center text-lg shadow-md">
                                    <i class="fas fa-language mr-2"></i> Dịch
                                </button>
                             </div>
                        </div>
                    </div>
                </div>

                <div class="bg-gray-800 p-6 rounded-xl shadow-lg border border-gray-700">
                     <h3 class="text-xl font-bold mb-4 border-b border-gray-700 pb-3 text-gray-100">2. Kết quả Dịch thuật</h3>
                     <div class="flex justify-between items-center mb-2">
                         <h4 class="font-semibold text-gray-200">Nội dung đã định dạng</h4>
                         <div class="flex items-center space-x-2">
                             <button id="copy-translation-btn" class="bg-gray-700 text-gray-300 px-3 py-1 rounded-md text-sm hover:bg-gray-600 transition"><i class="fas fa-copy"></i> Sao chép</button>
                         </div>
                     </div>
                     <div id="translation-loader" class="hidden items-center justify-center h-full">
                        <div class="loader"></div>
                     </div>
                     <textarea id="translation-output" readonly class="w-full p-3 border border-gray-700 rounded-md h-[480px] bg-gray-900 font-mono text-sm text-gray-300"></textarea>
                </div>
            </div>
        </section>
    </div>

    <!-- Toast container -->
    <div id="toast" class="toast"></div>
    
    <!-- Modal xác nhận xóa -->
    <div id="confirm-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 flex items-center justify-center p-4 hidden opacity-0 modal-backdrop">
        <div class="bg-gray-800 border border-gray-700 rounded-lg p-6 w-full max-w-sm mx-auto shadow-xl modal-content transform scale-95">
            <h3 class="text-lg font-bold text-white" id="modal-title">Xác nhận hành động</h3>
            <p class="text-gray-400 my-4" id="modal-body">Bạn có chắc chắn muốn thực hiện hành động này không?</p>
            <div class="flex justify-end space-x-4">
                <button id="modal-cancel" class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500 transition">Hủy</button>
                <button id="modal-confirm" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition">Xóa</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>